<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PropertyWize ‚Ä¢ Decision Tool</title>
<style>
  :root{
    --bg:#ffffff;              /* white page like v4 */
    --card:#f7f7f8;            /* soft gray card */
    --text:#222;
    --muted:#6b7280;
    --primary:#2563eb;         /* blue */
    --primary-ink:#fff;
    --line:#e5e7eb;
  }
  html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  .wrap{max-width:1100px;margin:0 auto;padding:18px}
  /* header */
  header{display:flex;align-items:center;justify-content:space-between;margin:4px 0 14px}
  .brand{display:flex;align-items:center;gap:10px}
  .brand img.logo{height:36px;width:auto;display:block}
  h1{font-size:22px;margin:0;font-weight:700}
  .mini{color:var(--muted);font-size:12px}
  /* layout */
  .grid{display:grid;grid-template-columns:240px 1fr;gap:18px}
  /* left pills */
  nav.card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:10px}
  label.pill{display:block;margin:6px 0}
  label.pill input{appearance:none}
  label.pill span{display:block;padding:10px 12px;border-radius:10px;border:1px solid var(--line);cursor:pointer}
  label.pill input:checked+span{background:var(--primary);color:var(--primary-ink);border-color:var(--primary)}
  .icon{margin-right:8px}
  /* right cards */
  .card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px}
  .view-pane.hidden{display:none}
  .hr{height:1px;background:var(--line);margin:12px 0}
  h2{margin:0 0 4px;font-size:20px}
  h3{margin:10px 0 6px;font-size:16px}
  p.note{color:var(--muted);margin:0 0 10px}
  .two-col{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .soft{background:#fff;border:1px solid var(--line);border-radius:10px;padding:12px}
  .field{display:grid;margin:8px 0}
  .field label{font-size:12px;color:var(--muted);margin-bottom:4px}
  .field input,.field select,.field textarea{
    border:1px solid var(--line);border-radius:8px;padding:10px;font:inherit;background:#fff
  }
  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .btn{border:1px solid var(--line);background:#fff;border-radius:10px;padding:9px 12px;cursor:pointer}
  .btn.primary{background:var(--primary);border-color:var(--primary);color:var(--primary-ink)}
  textarea[readonly]{background:#fafafa}
  footer{color:var(--muted);text-align:center;margin:24px 0}
</style>
</head>
<body>
<div class="wrap">
  <!-- header -->
  <header>
    <div class="brand">
      <img src="./pw-logo.png" alt="PropertyWize Logo" class="logo">
      <h1>PropertyWize ‚Ä¢ Decision Tool</h1>
    </div>
    <div class="mini">v4 (Full)</div>
  </header>

  <div class="grid">
    <!-- LEFT: role pills -->
    <nav id="rolePicker" class="card">
      <label class="pill">
        <input type="radio" name="role" value="maintenance" data-target="viewMaintenance" checked>
        <span><i class="icon">üõ†Ô∏è</i> Maintenance</span>
      </label>
      <label class="pill">
        <input type="radio" name="role" value="appliance" data-target="viewAppliance">
        <span><i class="icon">üç≥</i> Appliance Ticket</span>
      </label>
      <label class="pill">
        <input type="radio" name="role" value="finance" data-target="viewFinance">
        <span><i class="icon">üßæ</i> Finance</span>
      </label>
      <label class="pill">
        <input type="radio" name="role" value="nonmaint" data-target="viewNonMaint">
        <span><i class="icon">üßæ</i> Non-Maintenance Bill</span>
      </label>
      <label class="pill">
        <input type="radio" name="role" value="delinquency" data-target="viewDelinquency">
        <span><i class="icon">üìï</i> Delinquency</span>
      </label>
      <label class="pill">
        <input type="radio" name="role" value="listings" data-target="viewListings">
        <span><i class="icon">üìå</i> Stale Listing</span>
      </label>
    </nav>

    <!-- RIGHT: panes -->
    <section id="views" class="card">

      <!-- ========== Maintenance (Full SOP) ========== -->
      <div id="viewMaintenance" class="view-pane">
        <h2>Maintenance</h2>
        <p class="note">End-to-end maintenance workflow with Smart Intake.</p>

        <div class="hr"></div>
        <h3>Smart Intake (Auto-Route)</h3>
        <p class="note">Answer these quick questions and we‚Äôll take you to the right SOP.</p>

        <div class="two-col soft">
          <div class="field">
            <label>Is it an Emergency?</label>
            <select id="si_emergency">
              <option>No</option><option>Yes</option>
            </select>
          </div>
          <div class="field">
            <label>Owner completes own maintenance?</label>
            <select id="si_ownerMaint">
              <option>No</option><option>Yes</option>
            </select>
          </div>
          <div class="field">
            <label>Property in Delinquent status?</label>
            <select id="si_delinquent">
              <option>No</option><option>Yes</option>
            </select>
          </div>
          <div class="field">
            <label>Same issue within last 12 months?</label>
            <select id="si_recall">
              <option>No</option><option>Yes</option>
            </select>
          </div>
          <div class="field">
            <label>Enrolled in a Home Warranty program?</label>
            <select id="si_warranty">
              <option>No</option><option>Yes</option>
            </select>
          </div>
          <div class="field">
            <label>Is this specifically an Appliance ticket?</label>
            <select id="si_appliance">
              <option>No</option><option>Yes</option>
            </select>
          </div>
        </div>

        <div class="row" style="margin-top:10px">
          <button class="btn primary" id="si_continue">Continue</button>
          <button class="btn" id="si_clear">Clear</button>
        </div>

        <div class="hr"></div>
        <h3>Ticket Intake</h3>
        <div class="two-col">
          <div class="soft">
            <div class="field"><label>WO #</label><input id="mnt_wo" type="text" placeholder="123456"></div>
            <div class="field"><label>Property Address</label><input id="mnt_addr" type="text"></div>
            <div class="field"><label>Unit</label><input id="mnt_unit" type="text"></div>
            <div class="field">
              <label>Issue Type</label>
              <select id="mnt_issue_type">
                <option value="">Select‚Ä¶</option>
                <option>Emergency</option>
                <option>Urgent</option>
                <option>Routine</option>
                <option>Appliance</option>
              </select>
            </div>
            <div class="field"><label>Notes</label><textarea id="mnt_notes" rows="4"></textarea></div>
          </div>

          <div class="soft">
            <div class="field"><label>Photos / Docs</label><input id="mnt_docs" type="text" placeholder="links (Drive, etc.)"></div>
            <div class="field"><label>Vendor</label><input id="mnt_vendor" type="text" placeholder="TBD"></div>
            <div class="field"><label>Quoted / NTE</label><input id="mnt_nte" type="text" placeholder="$"></div>
            <div class="field"><label>Owner Plan</label>
              <select id="mnt_plan" onchange="mntPlanChange()">
                <option value="">Select plan‚Ä¶</option>
                <option value="warranty">Home Warranty</option>
                <option value="owner-does">Owner completes own tickets</option>
                <option value="pw-standard">PW Standard Dispatch</option>
                <option value="recall">Recall (‚â§ 12 months)</option>
              </select>
            </div>
          </div>
        </div>

        <div class="hr"></div>
        <h3>Generate Handoff</h3>
        <div class="row">
          <button class="btn primary" onclick="mntGenerate()">Generate</button>
          <button class="btn" onclick="copyOut('mnt_out')">Copy</button>
          <button class="btn" onclick="mntClear()">Clear</button>
        </div>
        <div class="field"><label>Handoff / Buildium Note</label><textarea id="mnt_out" readonly style="min-height:160px"></textarea></div>
      </div>

      <!-- ========== Appliance Ticket (standalone) ========== -->
      <div id="viewAppliance" class="view-pane hidden">
        <h2>Appliance Ticket Processing</h2>
        <p class="note">Follow SOP for refrigerators / ranges / DW / micro / washer / dryer.</p>

        <div class="hr"></div>
        <h3>Smart Intake (Appliances)</h3>
        <div class="two-col soft">
          <div class="field">
            <label>Is the ticket strictly an appliance?</label>
            <select id="ap_si_yes"><option>Yes</option><option>No</option></select>
          </div>
          <div class="field">
            <label>Under Home Warranty?</label>
            <select id="ap_si_warranty"><option>No</option><option>Yes</option></select>
          </div>
        </div>
        <div class="row" style="margin-top:10px">
          <button class="btn primary" id="ap_si_continue">Continue</button>
        </div>

        <div class="hr"></div>
        <h3>Ticket & Tenant</h3>
        <div class="two-col">
          <div class="soft">
            <div class="field"><label>WO #</label><input id="ap_wo" type="text"></div>
            <div class="field"><label>Property Address</label><input id="ap_addr" type="text"></div>
            <div class="field"><label>Unit</label><input id="ap_unit" type="text"></div>
            <div class="field"><label>Tenant Name/Phone</label><input id="ap_tenant" type="text"></div>
          </div>
          <div class="soft">
            <div class="field"><label>Appliance</label>
              <select id="ap_type">
                <option value="">Select‚Ä¶</option>
                <option>Refrigerator</option><option>Oven / Range</option>
                <option>Dishwasher</option><option>Microwave</option>
                <option>Washer</option><option>Dryer</option>
              </select>
            </div>
            <div class="field"><label>Issue</label><input id="ap_issue" type="text" placeholder="No cool / won‚Äôt start‚Ä¶"></div>
            <div class="field"><label>Warranty?</label>
              <select id="ap_warranty"><option>No</option><option>Yes</option></select>
            </div>
          </div>
        </div>

        <div class="hr"></div>
        <h3>Outputs</h3>
        <div class="row">
          <button class="btn primary" onclick="apGenerate()">Generate</button>
          <button class="btn" onclick="copyOut('ap_out')">Copy</button>
          <button class="btn" onclick="apClear()">Clear</button>
        </div>
        <div class="field"><label>Handoff / Buildium Note</label><textarea id="ap_out" readonly style="min-height:160px"></textarea></div>
      </div>

      <!-- ========== Finance ========== -->
      <div id="viewFinance" class="view-pane hidden">
        <h2>Finance</h2>
        <p class="note">WO & invoice checks, intake verification, spreadsheets, and email output.</p>

        <div class="hr"></div>
        <h3>WO & Invoice</h3>
        <div class="two-col">
          <div class="soft">
            <div class="field"><label>Invoice Ref / Link</label><input id="fi_ref" type="text"></div>
            <div class="field"><label>Amount</label><input id="fi_amt" type="text" placeholder="$"></div>
            <div class="field"><label>Vendor</label><input id="fi_vendor" type="text"></div>
            <div class="field"><label>Notes</label><textarea id="fi_notes" rows="4"></textarea></div>
          </div>
          <div class="soft">
            <h3>Intake Verification</h3>
            <div class="field"><label><input id="fi_ck_1" type="checkbox"> Scope matches WO</label></div>
            <div class="field"><label><input id="fi_ck_2" type="checkbox"> Tax & totals correct</label></div>
            <div class="field"><label><input id="fi_ck_3" type="checkbox"> Backups attached</label></div>
            <div class="field"><label><input id="fi_ck_4" type="checkbox"> Payee verified</label></div>
          </div>
        </div>

        <div class="hr"></div>
        <h3>Outputs</h3>
        <div class="row">
          <button class="btn primary" onclick="fiGenerate()">Generate</button>
          <button class="btn" onclick="copyOut('fi_out')">Copy</button>
          <button class="btn" onclick="fiClear()">Clear</button>
        </div>
        <div class="field"><label>Email / Handoff</label><textarea id="fi_out" readonly style="min-height:160px"></textarea></div>
      </div>

      <!-- ========== Non-Maintenance Bill ========== -->
      <div id="viewNonMaint" class="view-pane hidden">
        <h2>Non-Maintenance Bill Handoff</h2>
        <p class="note">For bills not tied to a maintenance ticket.</p>

        <div class="two-col">
          <div class="soft">
            <div class="field"><label>Bill #</label><input id="nb_bill" type="text"></div>
            <div class="field"><label>Vendor</label><input id="nb_vendor" type="text"></div>
            <div class="field"><label>Amount</label><input id="nb_amt" type="text" placeholder="$"></div>
            <div class="field"><label>Notes</label><input id="nb_notes" type="text"></div>
          </div>
          <div class="soft">
            <div class="field"><label>Notify (emails)</label><input id="nb_notify" type="text" placeholder="a@b.com; c@d.com"></div>
            <div class="field"><label>Due date</label><input id="nb_due" type="date"></div>
            <div class="field"><label>Tags</label><input id="nb_tags" type="text" placeholder="utility,tax,‚Ä¶"></div>
          </div>
        </div>

        <div class="hr"></div>
        <h3>Outputs</h3>
        <div class="row">
          <button class="btn primary" onclick="nbGenerate()">Generate</button>
          <button class="btn" onclick="copyOut('nb_out')">Copy</button>
          <button class="btn" onclick="nbClear()">Clear</button>
        </div>
        <div class="field"><label>Handoff / Email</label><textarea id="nb_out" readonly style="min-height:160px"></textarea></div>
      </div>

      <!-- ========== Delinquency ========== -->
      <div id="viewDelinquency" class="view-pane hidden">
        <h2>Delinquency Handoff Tool</h2>
        <p class="note">Summarize tenants with balances and generate an owner handoff.</p>

        <div class="two-col">
          <div class="soft">
            <div class="field"><label>Property</label><input id="dlq_prop" type="text"></div>
            <div class="field"><label>Tenant</label><input id="dlq_tenant" type="text"></div>
            <div class="field"><label>Balance</label><input id="dlq_bal" type="text" placeholder="$"></div>
          </div>
          <div class="soft">
            <div class="field"><label>Status</label><select id="dlq_status"><option>Promise to Pay</option><option>No Response</option><option>Payment Plan</option></select></div>
            <div class="field"><label>Notes</label><textarea id="dlq_notes" rows="4"></textarea></div>
          </div>
        </div>

        <div class="hr"></div>
        <h3>Outputs</h3>
        <div class="row">
          <button class="btn primary" onclick="dlqGenerate()">Generate</button>
          <button class="btn" onclick="copyOut('dlq_out')">Copy</button>
          <button class="btn" onclick="dlqClear()">Clear</button>
        </div>
        <div class="field"><label>Owner Handoff</label><textarea id="dlq_out" readonly style="min-height:160px"></textarea></div>
      </div>

      <!-- ========== Stale Listing ========== -->
      <div id="viewListings" class="view-pane hidden">
        <h2>Stale Listing ‚Ä¢ Weekly Owner Report</h2>
        <p class="note">For any unit &gt; 14 days w/ no apps OR ‚â• 30 days with no approved applicants. Drafts go to EPM for approval before sending to owner.</p>

        <div class="hr"></div>
        <h3>Listing Details</h3>
        <div class="two-col">
          <div class="soft">
            <div class="field"><label>Property Address</label><input id="sl_address" type="text"></div>
            <div class="field"><label>Owner Name (optional)</label><input id="sl_owner" type="text"></div>
            <div class="field"><label>Date Listed</label><input id="sl_listed" type="date" onchange="sl_calcDOM()"></div>
            <div class="field"><label>List Rent (USD)</label><input id="sl_rent" type="text" placeholder="$1,895"></div>
          </div>
          <div class="soft">
            <div class="field"><label>Days on Market (DOM)</label><input id="sl_dom" type="number" placeholder="auto" readonly></div>
            <div class="row"><button type="button" class="btn" onclick="sl_calcDOM()">Recalculate DOM</button></div>
            <div class="field"><label>Unit/Notes ID (optional)</label><input id="sl_unitid" type="text" placeholder="Buildium Unit # or WO #"></div>
          </div>
        </div>

        <div class="hr"></div>
        <h3>Applications & Showings</h3>
        <div class="two-col">
          <div class="soft">
            <div class="field"><label>New Apps</label><input id="sl_apps_new" type="number" min="0" value="0"></div>
            <div class="field"><label>Pending</label><input id="sl_apps_pending" type="number" min="0" value="0"></div>
            <div class="field"><label>Approved</label><input id="sl_apps_approved" type="number" min="0" value="0"></div>
            <div class="field"><label>Declined</label><input id="sl_apps_declined" type="number" min="0" value="0"></div>
          </div>
          <div class="soft">
            <div class="field"><label>Showings (last 7 days)</label><input id="sl_showings" type="number" min="0" value="0"></div>
            <div class="field"><label>Feedback (short)</label><input id="sl_feedback" type="text" placeholder="Price high / Needs photos"></div>
          </div>
        </div>

        <div class="hr"></div>
        <h3>Outputs</h3>
        <div class="row">
          <button class="btn primary" onclick="slGenerate()">Generate Owner Report</button>
          <button class="btn" onclick="copyOut('sl_out')">Copy Email Body</button>
        </div>
        <div class="field"><label>Owner Report / Email Body</label><textarea id="sl_out" readonly style="min-height:200px"></textarea></div>

        <div class="hr"></div>
        <h3>Handoff</h3>
        <div class="row"><button type="button" class="btn" onclick="sl_copy('sl_handoff')">Copy Handoff Comment</button></div>
        <div class="field"><textarea id="sl_handoff" readonly></textarea></div>
      </div>

    </section>
  </div>

  <footer>¬© 2025 PropertyWize ‚Ä¢ This single-file tool runs entirely in your browser.</footer>
</div>

<script>
/* ---------- utilities ---------- */
function showPane(id){
  document.querySelectorAll('.view-pane').forEach(p=>p.classList.add('hidden'));
  const t = document.getElementById(id);
  if(t) t.classList.remove('hidden');
  try{ localStorage.setItem('pw_role_pane', id);}catch(_){}
}

/* ---------- nav wiring ---------- */
document.querySelectorAll('#rolePicker input[name="role"]').forEach(r=>{
  r.addEventListener('change', e=>{
    const id = e.target.dataset.target;
    if(id) showPane(id);
  });
});

/* restore last pane (default Maintenance) */
(function(){
  const saved = localStorage.getItem('pw_role_pane') || 'viewMaintenance';
  const match = document.querySelector(`#rolePicker input[data-target="${saved}"]`);
  if(match){ match.checked = true; showPane(saved); }
  else { showPane('viewMaintenance'); }
})();

/* ---------- SMART INTAKE (Maintenance) ---------- */
document.getElementById('si_continue').addEventListener('click', ()=>{
  const emergency  = val('#si_emergency') === 'Yes';
  const delinquent = val('#si_delinquent') === 'Yes';
  const warranty   = val('#si_warranty') === 'Yes';
  const ownerDoes  = val('#si_ownerMaint') === 'Yes';
  const recall     = val('#si_recall') === 'Yes';
  const isAppl     = val('#si_appliance') === 'Yes';

  let target = 'viewMaintenance';
  if(isAppl){ target = 'viewAppliance'; }
  else if(delinquent){ target = 'viewDelinquency'; }
  else { target = 'viewMaintenance'; }

  /* pre-fill Owner Plan when applicable */
  if(target==='viewMaintenance'){
    const plan = document.getElementById('mnt_plan');
    if(recall) plan.value = 'recall';
    else if(ownerDoes) plan.value = 'owner-does';
    else if(warranty) plan.value = 'warranty';
    else plan.value = 'pw-standard';
  }

  selectNavByTarget(target);
  showPane(target);
  document.getElementById(target).scrollIntoView({behavior:'smooth',block:'start'});
});

document.getElementById('si_clear').addEventListener('click', ()=>{
  ['#si_emergency','#si_ownerMaint','#si_delinquent','#si_recall','#si_warranty','#si_appliance']
    .forEach(s=>document.querySelector(s).value='No');
});

function selectNavByTarget(target){
  const r = document.querySelector(`#rolePicker input[data-target="${target}"]`);
  if(r) r.checked = true;
}

function val(sel){ return document.querySelector(sel)?.value || ''; }

/* ---------- Maintenance handoff ---------- */
function mntPlanChange(){ /* hook for future behavior */ }
function mntGenerate(){
  const wo   = val('#mnt_wo');
  const addr = val('#mnt_addr');
  const unit = val('#mnt_unit');
  const type = val('#mnt_issue_type');
  const plan = val('#mnt_plan');
  const nte  = val('#mnt_nte');
  const notes= val('#mnt_notes');
  const out = [
    `HANDOFF ‚Äî Maintenance`,
    `WO: ${wo||'TBD'} ‚Ä¢ ${addr}${unit?(' #'+unit):''}`,
    `Type: ${type||'n/a'} ‚Ä¢ Plan: ${plan||'n/a'} ‚Ä¢ NTE: ${nte||'n/a'}`,
    notes?`Notes: ${notes}`:'',
    ''
  ].filter(Boolean).join('\n');
  setOut('mnt_out', out);
}
function mntClear(){ ['#mnt_wo','#mnt_addr','#mnt_unit','#mnt_issue_type','#mnt_plan','#mnt_nte','#mnt_notes','#mnt_docs','#mnt_vendor'].forEach(s=>{const el=document.querySelector(s); if(el){el.value='';}}); setOut('mnt_out',''); }

/* ---------- Appliance handoff ---------- */
document.getElementById('ap_si_continue').addEventListener('click', ()=>{
  // If not actually an appliance, bounce them back to Maintenance
  if(val('#ap_si_yes')==='No'){ selectNavByTarget('viewMaintenance'); showPane('viewMaintenance'); }
});
function apGenerate(){
  const out = [
    'HANDOFF ‚Äî Appliance',
    `WO: ${val('#ap_wo')||'TBD'} ‚Ä¢ ${val('#ap_addr')}${val('#ap_unit')?(' #'+val('#ap_unit')):''}`,
    `Appliance: ${val('#ap_type')||'n/a'} ‚Ä¢ Warranty: ${val('#ap_warranty')||'No'}`,
    `Tenant: ${val('#ap_tenant')||'n/a'}`,
    `Issue: ${val('#ap_issue')||'n/a'}`,
    ''
  ].join('\n');
  setOut('ap_out', out);
}
function apClear(){ ['#ap_wo','#ap_addr','#ap_unit','#ap_tenant','#ap_type','#ap_warranty','#ap_issue'].forEach(s=>{const el=document.querySelector(s); if(el){el.value='';}}); setOut('ap_out',''); }

/* ---------- Finance ---------- */
function fiGenerate(){
  const out = [
    'FINANCE ‚Äî Review',
    `Ref: ${val('#fi_ref')||'n/a'} ‚Ä¢ Vendor: ${val('#fi_vendor')||'n/a'} ‚Ä¢ Amount: ${val('#fi_amt')||'n/a'}`,
    `Checks:`,
    ` - Scope matches WO: ${document.getElementById('fi_ck_1').checked?'Yes':'No'}`,
    ` - Tax & totals correct: ${document.getElementById('fi_ck_2').checked?'Yes':'No'}`,
    ` - Backups attached: ${document.getElementById('fi_ck_3').checked?'Yes':'No'}`,
    ` - Payee verified: ${document.getElementById('fi_ck_4').checked?'Yes':'No'}`,
    val('#fi_notes')?('\nNotes: '+val('#fi_notes')):'',
    ''
  ].join('\n');
  setOut('fi_out', out);
}
function fiClear(){ ['#fi_ref','#fi_vendor','#fi_amt','#fi_notes'].forEach(s=>{const el=document.querySelector(s); if(el){el.value='';}}); ['fi_ck_1','fi_ck_2','fi_ck_3','fi_ck_4'].forEach(id=>document.getElementById(id).checked=false); setOut('fi_out',''); }

/* ---------- Non-Maintenance Bill ---------- */
function nbGenerate(){
  const out = [
    'HANDOFF ‚Äî Non-Maintenance Bill',
    `Bill: ${val('#nb_bill')||'n/a'} ‚Ä¢ Vendor: ${val('#nb_vendor')||'n/a'} ‚Ä¢ Amount: ${val('#nb_amt')||'n/a'}`,
    `Tags: ${val('#nb_tags')||'n/a'} ‚Ä¢ Due: ${val('#nb_due')||'n/a'}`,
    val('#nb_notes')?('Notes: '+val('#nb_notes')):'',
    `Notify: ${val('#nb_notify')||'n/a'}`,
    ''
  ].join('\n');
  setOut('nb_out', out);
}
function nbClear(){ ['#nb_bill','#nb_vendor','#nb_amt','#nb_notes','#nb_tags','#nb_due','#nb_notify'].forEach(s=>{const el=document.querySelector(s); if(el){el.value='';}}); setOut('nb_out',''); }

/* ---------- Delinquency ---------- */
function dlqGenerate(){
  const out = [
    'DELINQUENCY ‚Äî Handoff',
    `Property: ${val('#dlq_prop')||'n/a'}`,
    `Tenant: ${val('#dlq_tenant')||'n/a'} ‚Ä¢ Balance: ${val('#dlq_bal')||'n/a'}`,
    `Status: ${val('#dlq_status')||'n/a'}`,
    val('#dlq_notes')?('Notes: '+val('#dlq_notes')):'',
    ''
  ].join('\n');
  setOut('dlq_out', out);
}
function dlqClear(){ ['#dlq_prop','#dlq_tenant','#dlq_bal','#dlq_notes'].forEach(s=>{const el=document.querySelector(s); if(el){el.value='';}}); setOut('dlq_out',''); }

/* ---------- Stale Listing ---------- */
function sl_calcDOM(){
  const d = document.getElementById('sl_listed').value;
  if(!d) return;
  const then = new Date(d), now = new Date();
  const ms = now - then; const days = Math.max(0, Math.round(ms/86400000));
  document.getElementById('sl_dom').value = days;
}
function slGenerate(){
  const out = [
    'STALE LISTING ‚Äî Weekly Owner Report',
    `${val('#sl_address')||'Property'} (${val('#sl_unitid')||'n/a'})`,
    `Listed: ${val('#sl_listed')||'n/a'} ‚Ä¢ DOM: ${val('#sl_dom')||'n/a'} ‚Ä¢ Rent: ${val('#sl_rent')||'n/a'}`,
    `Apps: New ${val('#sl_apps_new')||0} ‚Ä¢ Pending ${val('#sl_apps_pending')||0} ‚Ä¢ Approved ${val('#sl_apps_approved')||0} ‚Ä¢ Declined ${val('#sl_apps_declined')||0}`,
    `Showings (7d): ${val('#sl_showings')||0} ‚Ä¢ Feedback: ${val('#sl_feedback')||'n/a'}`,
    ''
  ].join('\n');
  setOut('sl_out', out);
}
function sl_copy(id){ copyOut(id); }

/* ---------- helpers ---------- */
function setOut(id, text){ const el=document.getElementById(id); if(el){ el.value=text; el.scrollTop=0; } }
function copyOut(id){
  const el = document.getElementById(id);
  if(!el) return;
  el.select();
  try{ navigator.clipboard.writeText(el.value); }catch(_){}
}
</script>
</body>
</html>
